!include common.yaml
---
- package: mapDamage
  name: mapDamage 
  version: "{{versions.mapDamage}}"
  pyversion: "{{versions.python3}}"
  vendor_source: https://github.com/ginolhac/mapDamage/archive/{{version}}.{{extension}}
  description: |
    mapDamage2 {{version}} is a computational framework written in Python3 and R,
    which tracks and quantifies DNA damage patterns among ancient DNA sequencing
    reads generated by Next-Generation Sequencing platforms.
  build:
    configure: echo no configure required
    pkgmake: >
      python setup.py build;
      cp -r mapdamage/tests/probs/ build/lib/mapdamage/tests/;
      sed -i 's%\#\! /usr/bin/%\#\!/usr/bin/env %' mapdamage/Rscripts/stats/*.R
    target:
    modules: 
      - "{{compiler}}/{{compiler_version}}"
      - python/{{pyversion}}
      - R/{{versions.R}}
  install:
    makeinstall: >
      mkdir $(ROOT){{root}};
      python setup.py install --prefix $(ROOT){{root}}
    installextra: >
      $(INSTALL) README* LICENSE* MANIFEST $(ROOT){{root}}
  requires:
    - "{{compiler}}_{{compiler_version}}"
    - "python_{{pyversion}}"
    - "R_{{versions.R}}-inline"
    - "R_{{versions.R}}-ggplot2"
    - "R_{{versions.R}}-gam"
    - "R_{{versions.R}}-Rcpp"
    - "R_{{versions.R}}-RcppGSL"
  files:
    - "{{root}}"
