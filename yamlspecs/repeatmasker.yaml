!include common.yaml
---
- package: 
  name: repeatmasker 
  release: "3"
  version: "{{versions.repeatmasker}}"
  vendor_source: http://www.repeatmasker.org/RepeatMasker-{{version}}.{{extension}}
  src_dir: RepeatMasker
  addfile: 
    - filter-requires-{{name}}.sh
    - filter-provides-{{name}}.sh
  description: |
    RepeatMasker {{version}} is a program that screens DNA sequences for interspersed
    repeats and low complexity DNA sequences. See http://www.repeatmasker.org
  build:
    modules: 
      - perl/{{versions.perl}}
      - python/{{versions.python3}}
      - trf/{{versions.trf}}
      - ncbi-blast/{{versions.ncbiblast}}
      - hmmer/{{versions.hmmer}}
  install:
     makeinstall: >
       echo "{{versions.perl}}" > ../PERLVERSION;
       mkdir -p $(ROOT){{root}};
       sed -i '/\.*maskFile.pl/d' configure;
       perl ./configure -trf_prgm $$TRF_HOME/bin/trf -hmmer_dir $$HMMER_HOME/bin -rmblast_dir $$BLAST_HOME/bin -default_search_engine nhmmer;
       sed -i 's%/usr/local/bin/perl%/usr/bin/env perl%' *.pm util/*;
       /bin/rm *.pm.bak *.jpg configure *.html INSTALL;
       $(TAR) cf - . | (cd $(ROOT){{root}}; tar xf -)
  requires:
     - perl_{{versions.perl}}
     - perl_{{versions.perl}}-Text-Soundex
  rpmFilters: *filterRequiresProvides
